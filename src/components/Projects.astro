---
import { Image } from 'astro:assets';
import { Icon } from 'astro-icon/components';
import { projects as defaultProjects, type Project } from '../data/projects';

interface Props {
	projects?: Project[];
}

const { projects = defaultProjects } = Astro.props;
---

<section class="mb-32" data-animate="section">
	<div class="flex items-center justify-center mb-16">
		<div class="h-px w-12 bg-gray-800 mr-4"></div>
		<h2 class="text-xs uppercase tracking-widest text-gray-500">Proyectos</h2>
		<div class="h-px w-12 bg-gray-800 ml-4"></div>
	</div>

	{/* Mosaico: 1 destacada + secundarias (rompe simetr√≠a y se ve menos plantilla) */}
	<div class="grid grid-cols-1 md:grid-cols-6 gap-6">
		{projects.map((project, idx) => {
			const isFeatured = idx === 0;
			return (
				<article
					class={`glass-panel rounded-2xl overflow-hidden transition-all group hover:border-white/20 h-full flex flex-col ${isFeatured ? 'md:col-span-4' : 'md:col-span-2'}`}
				>
					<div class={`project-thumb relative overflow-hidden ${project.image ? 'has-image' : ''} ${isFeatured ? 'aspect-video' : 'flex-1 min-h-[140px]'}`}>
						{project.image && (
							<Image 
								src={project.image} 
								alt={project.title} 
								class="absolute inset-0 w-full h-full object-cover transition-transform duration-500 ease-out group-hover:scale-110"
							/>
						)}
						<div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/30 to-transparent opacity-0 group-hover:opacity-100 transition-all duration-300"></div>
						{project.tagline && (
							<div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-300 delay-100 p-6">
								<div class="px-6 py-4 rounded-2xl bg-black/40 backdrop-blur-md border border-white/10 transform translate-y-4 group-hover:translate-y-0 transition-transform duration-400 shadow-2xl">
									<p class="text-base md:text-lg italic font-light text-white text-center leading-relaxed">
										"{project.tagline}"
									</p>
								</div>
							</div>
						)}
					</div>

					<div class={`p-5 ${isFeatured ? 'md:p-6' : 'md:p-5'}`}>
						<div class="flex items-start justify-between gap-4">
							<div class="min-w-0">
								<h3 class="text-sm font-medium text-white mb-2 truncate">{project.title}</h3>
								<p class="text-xs text-gray-400 line-clamp-2">{project.description}</p>
							</div>

							<div class="flex shrink-0 items-center gap-2">
								<a
									href={project.demoUrl}
									target="_blank"
									rel="noopener noreferrer"
									class="glass-btn w-9 h-9 rounded-full flex items-center justify-center text-white/80 hover:text-white"
									aria-label="Enlace a demo o repositorio"
								>
									<Icon name="mdi:link" class="w-4 h-4" />
								</a>
								<a
									href={project.repoUrl}
									target="_blank"
									rel="noopener noreferrer"
									class="glass-btn w-9 h-9 rounded-full flex items-center justify-center text-white/80 hover:text-white"
									aria-label="Enlace al repositorio"
								>
									<Icon name="simple-icons:github" class="w-4 h-4" />
								</a>
							</div>
						</div>

						{project.tags && project.tags.length > 0 && (
							<div class="mt-4 flex flex-wrap gap-2">
								{project.tags.map((tag) => (
									<span class="px-2.5 py-1 rounded-full text-[10px] uppercase tracking-wider text-white/70 bg-white/5 border border-white/10">
										{tag}
									</span>
								))}
							</div>
						)}
					</div>
				</article>
			);
		})}
	</div>
</section>
