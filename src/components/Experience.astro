---
import { Icon } from 'astro-icon/components';
import { experiences } from '../data/experience';
import ExperienceCard from './ExperienceCard.astro';
---

<section class="mb-32">
	<div class="flex items-center justify-center mb-16">
		<div class="h-px w-12 bg-gray-800 mr-4"></div>
		<h2 class="text-xs uppercase tracking-widest text-gray-500">Experiencia</h2>
		<div class="h-px w-12 bg-gray-800 ml-4"></div>
	</div>

	<!-- Timeline desktop: línea vertical centrada + ítems alternados -->
	<div class="relative max-w-4xl mx-auto hidden md:block">
		<!-- Línea vertical central -->
		<div 
			class="absolute left-1/2 top-0 bottom-0 w-0.5 -translate-x-1/2 hidden md:block bg-purple-500/50"
		></div>

		<div class="space-y-0">
			{experiences.map((exp, index) => {
				const isLeft = index % 2 === 0;
				return (
					<div class="relative flex flex-col md:flex-row md:items-center min-h-[120px] py-6 md:py-8" data-experience-item data-experience-side={isLeft ? 'left' : 'right'}>
						<!-- Columna izquierda: card si isLeft, si no vacío -->
						<div class="md:w-1/2 md:pr-6 flex md:justify-end">
							{isLeft ? (
								<>
									<ExperienceCard experience={exp} />
									<!-- Conector horizontal (desktop) -->
									<div class="hidden md:flex flex-1 min-w-[24px] items-center">
										<div class="h-0.5 w-full bg-purple-500/60"></div>
									</div>
								</>
							) : (
								<div class="hidden md:block w-full max-w-lg"></div>
							)}
						</div>

						<!-- Centro: nodo -->
						<div class="absolute left-1/2 -translate-x-1/2 md:relative md:left-0 md:translate-x-0 flex-shrink-0 w-4 h-4 flex items-center justify-center z-10 mt-4 md:mt-0">
							<div class="w-3 h-3 rounded-full md:w-4 md:h-4 bg-purple-500"></div>
						</div>

						<!-- Columna derecha: vacío si isLeft, card si !isLeft -->
						<div class="md:w-1/2 md:pl-6 flex md:justify-start">
							{!isLeft ? (
								<>
									<!-- Conector horizontal (desktop) -->
									<div class="hidden md:flex flex-1 min-w-[24px] items-center">
										<div class="h-0.5 w-full bg-purple-500/60"></div>
									</div>
									<ExperienceCard experience={exp} />
								</>
							) : (
								<div class="hidden md:block w-full max-w-lg"></div>
							)}
						</div>
					</div>
				);
			})}
		</div>
	</div>

	<!-- Móvil: timeline simplificada (línea izquierda, cards a la derecha) -->
	<div class="md:hidden max-w-4xl mx-auto relative pl-2">
		<div class="absolute left-0 top-0 bottom-0 w-0.5 bg-purple-500/40"></div>
		{experiences.map((exp) => (
			<div class="relative flex gap-4 pl-5 pb-8 last:pb-0" data-experience-item data-experience-mobile>
				<div class="absolute left-0 top-6 w-3 h-3 rounded-full -translate-x-1/2 z-10 bg-purple-500"></div>
				<div class="flex-1 ml-1">
					<ExperienceCard experience={exp} />
				</div>
			</div>
		))}
	</div>
</section>
